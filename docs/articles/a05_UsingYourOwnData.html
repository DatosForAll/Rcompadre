<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using your own matrix data • Rcompadre</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using your own matrix data">
<meta property="og:description" content="Rcompadre">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rcompadre</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_GettingStarted.html">Getting started with Rcompadre</a>
    </li>
    <li>
      <a href="../articles/a02_RcompadreTidy.html">Using Rcompadre with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/a03_VectorisingRcompadre.html">Vectorising with Rcompadre</a>
    </li>
    <li>
      <a href="../articles/a04_ObtainingReferences.html">Obtaining references</a>
    </li>
    <li>
      <a href="../articles/a05_UsingYourOwnData.html">Using your own matrix data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jonesor/Rcompadre/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a05_UsingYourOwnData_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using your own matrix data</h1>
                        <h4 class="author">Owen Jones</h4>
            
            <h4 class="date">2021-10-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jonesor/Rcompadre/blob/master/vignettes/a05_UsingYourOwnData.Rmd"><code>vignettes/a05_UsingYourOwnData.Rmd</code></a></small>
      <div class="hidden name"><code>a05_UsingYourOwnData.Rmd</code></div>

    </div>

    
    
<p>The utility of <code>Rcompadre</code> extends beyond the use of data from the COMPADRE and COMADRE matrix databases. By coercing user-provided matrix population model (MPM) data (and metadata) into the standardised format used by the <code>Rcompadre</code> package (a <code>CompadreDB</code> object) you can make use of all the functionality of the package. The central function to carry out this is <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code>.</p>
<p>This vignette illustrates some simple use cases.</p>
<div id="the-compadredb-object" class="section level2">
<h2 class="hasAnchor">
<a href="#the-compadredb-object" class="anchor"></a>The <code>CompadreDB</code> object</h2>
<p>Before illustrating the construction of a <code>CompadreDB</code> object using <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> is it first necessary to outline the anatomy of the object.</p>
<p>The <code>CompadreDB</code> object consists of four parts: (1) the matrices; (2) the stage information; (3) the metadata describing the matrices; and (4) version information. Much of this information can be generated automatically by the <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> function.</p>
<div id="the-matrices" class="section level3">
<h3 class="hasAnchor">
<a href="#the-matrices" class="anchor"></a>The matrices</h3>
<p>MPM data can exist as <em>A</em> matrices (i.e. the whole MPM model) but can also exist as a series of submatrices that sum to the <em>A</em> matrix. Typically these matrices are based on demographic processes such as growth and survival, sexual reproduction and clonal reproduction. These matrices are commonly denoted as the <em>U</em>, <em>F</em> and <em>C</em> matrices respectively, and <em>A</em> = <em>U</em> + <em>F</em> + <em>C</em> (Caswell 2001, Salguero-Gómez et al. 2015, 2016).</p>
<p>Thus, each MPM in the <code>CompadreDB</code> object is provided as a list object with four elements representing this set of matrices: <em>A</em>, the full MPM and the three demographic process-based submatrices (<em>U</em>, <em>F</em> and <em>C</em>).</p>
<p>In some cases it is not desirable (or perhaps impossible) to provide information for the set of submatrices. For example, it may not be possible to distinguish between sexual (<em>F</em>) and clonal (<em>C</em>) reproduction, or between growth/survival (<em>U</em>) and reproduction (<em>F</em> and/or <em>C</em>). Alternatively, it may simply be that the planned analyses do not require the potentially laborious splitting of the <em>A</em> matrix into these submatrices. Nevertheless, <code>CompadreDB</code> requires the full set of four matrices. Thankfully, the matrices can be provided as <code>NA</code> matrices and can often be generated automatically from the provided data (see below).</p>
<ul>
<li>If only the <em>A</em> matrices are provided, <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> will automatically populate the <em>U</em>, <em>F</em> and <em>c</em> matrices with <code>NA</code> values.</li>
<li>If a <em>U</em> matrix is provided, an <em>F</em> and/or <em>C</em> matrix must also be provided. If only one of the <em>F</em> and <em>C</em> matrices is provided, the other is assumed to be 0. The <em>A</em> matrix is then calculated automatically from these sets as <em>A</em> = <em>U</em> + <em>F</em> + <em>C</em>.</li>
</ul>
<p>Sets of matrices of the same type must be provided as a <code>list</code> for each type. For example, you could provide two lists: one for the <em>U</em> matrices and one for the matching <em>F</em> matrices. The function conducts some error checks to ensure that these lists have the same length, and that all matrices in each set has the same dimensions.</p>
</div>
<div id="the-stage-information" class="section level3">
<h3 class="hasAnchor">
<a href="#the-stage-information" class="anchor"></a>The stage information</h3>
<p>Each MPM has a life-cycle divided into two or more discrete stages. The <code>CompadreDB</code> object must include this information, and it is provided as a <code>list</code> of <code>data.frame</code>s (one for each MPM).</p>
</div>
<div id="the-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#the-metadata" class="anchor"></a>The metadata</h3>
<p>A valid <code>CompadreDB</code> object MUST include a <code>data.frame</code> of metadata with a number of rows equal to the number of MPMs.</p>
<p>This metadata, can be minimal or very extensive, depending on the users’ needs. In the simplest case, for example with simulated data, this might simply be an ID number, or perhaps parameters used in simulation. In cases with empirical MPMs the metadata will typically include taxonomic information on the species, the geographic location, the name of the study site, the year or time-frame of study and so on. Thus, the metadata data.frame can include anything from one to hundreds of columns.</p>
</div>
<div id="version-information" class="section level3">
<h3 class="hasAnchor">
<a href="#version-information" class="anchor"></a>Version information</h3>
<p>Finally, some version information must be included. This can simply be a name, or a date intended to help keep track of multiple version of the data.</p>
</div>
</div>
<div id="data-preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>Data preparation</h2>
<p>The main function used for creating a <code>CompadreDB</code> object from user-defined data is <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code>. This function takes the components described above, performs some error checks, and combines them into a single <code>CompadreDB</code> object.</p>
</div>
<div id="a-simple-example" class="section level1">
<h1 class="hasAnchor">
<a href="#a-simple-example" class="anchor"></a>A simple example</h1>
<p>First we need to load the library, and the <code>dplyr</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/Rcompadre">Rcompadre</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span></code></pre></div>
<p>In this example we generate a series of 2 dimension <em>A</em> matrices using a series of uniform distributions for the <em>U</em> submatrix, and a gamma distribution, to approximate the average of a Poisson process. In this case, the matrices all have the same dimension, but it is not necessary for dimension to be the same. This is a bit long-winded, and there are certainly better ways to simulate these data (e.g. using a Dirichlet distribution), but the example serves a useful purpose here.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nMat</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="va">mort1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">u1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">mort1</span><span class="op">)</span>
<span class="va">u2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">mort1</span> <span class="op">-</span> <span class="va">u1</span>
<span class="va">mort2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">u3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">mort2</span><span class="op">)</span>
<span class="va">u4</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">mort2</span> <span class="op">-</span> <span class="va">u3</span>

<span class="va">Uvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">u1</span>, <span class="va">u2</span>, <span class="va">u3</span>, <span class="va">u4</span><span class="op">)</span>
<span class="va">Fvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span><span class="op">(</span><span class="va">nMat</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="va">Avals</span> <span class="op">&lt;-</span> <span class="va">Uvals</span>
<span class="va">Avals</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Avals</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">Fvals</span>

<span class="va">Alist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Avals</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">matrix</span>,
  byrow <span class="op">=</span> <span class="cn">FALSE</span>,
  nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span></code></pre></div>
<p>Next we use <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> to convert this list of matrices into a COMPADRE object. Here I am adding an identifier to each matrix, and a column for the shape parameter for the Gamma distribution used to simulate the data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>idNum <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, shapeParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdb_build_cdb.html">cdb_build_cdb</a></span><span class="op">(</span>mat_a <span class="op">=</span> <span class="va">Alist</span>, metadata <span class="op">=</span> <span class="va">meta</span><span class="op">)</span>
<span class="co">#&gt; Warning in cdb_build_cdb(mat_a = Alist, metadata = meta): Metadata does not</span>
<span class="co">#&gt; include a `SpeciesAccepted` column, so number of species not provided when</span>
<span class="co">#&gt; viewing object.</span>
<span class="va">x</span>
<span class="co">#&gt; A COM(P)ADRE database ('CompadreDB') object with ?? SPECIES and 20 MATRICES.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 20 × 3</span>
<span class="co">#&gt;    mat        idNum shapeParam</span>
<span class="co">#&gt;    &lt;list&gt;     &lt;int&gt;      &lt;int&gt;</span>
<span class="co">#&gt;  1 &lt;CompdrMt&gt;     1          1</span>
<span class="co">#&gt;  2 &lt;CompdrMt&gt;     2          1</span>
<span class="co">#&gt;  3 &lt;CompdrMt&gt;     3          1</span>
<span class="co">#&gt;  4 &lt;CompdrMt&gt;     4          1</span>
<span class="co">#&gt;  5 &lt;CompdrMt&gt;     5          1</span>
<span class="co">#&gt;  6 &lt;CompdrMt&gt;     6          2</span>
<span class="co">#&gt;  7 &lt;CompdrMt&gt;     7          2</span>
<span class="co">#&gt;  8 &lt;CompdrMt&gt;     8          2</span>
<span class="co">#&gt;  9 &lt;CompdrMt&gt;     9          2</span>
<span class="co">#&gt; 10 &lt;CompdrMt&gt;    10          2</span>
<span class="co">#&gt; 11 &lt;CompdrMt&gt;    11          3</span>
<span class="co">#&gt; 12 &lt;CompdrMt&gt;    12          3</span>
<span class="co">#&gt; 13 &lt;CompdrMt&gt;    13          3</span>
<span class="co">#&gt; 14 &lt;CompdrMt&gt;    14          3</span>
<span class="co">#&gt; 15 &lt;CompdrMt&gt;    15          3</span>
<span class="co">#&gt; 16 &lt;CompdrMt&gt;    16          4</span>
<span class="co">#&gt; 17 &lt;CompdrMt&gt;    17          4</span>
<span class="co">#&gt; 18 &lt;CompdrMt&gt;    18          4</span>
<span class="co">#&gt; 19 &lt;CompdrMt&gt;    19          4</span>
<span class="co">#&gt; 20 &lt;CompdrMt&gt;    20          4</span></code></pre></div>
<p>We can look at the matrices using the normal <code>Rcompadre</code> function <code><a href="../reference/CompadreMatrixMethods.html">matA()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/CompadreMatrixMethods.html">matA</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;            [,1]      [,2]</span>
<span class="co">#&gt; [1,] 0.03665583 0.6548161</span>
<span class="co">#&gt; [2,] 0.88378346 0.3266225</span></code></pre></div>
<p>Now the matrices are stored in a <code>CompadreDB</code> object they can be manipulated in the same diverse ways as the <code>CompadreDB</code> object downloaded from the COMPADRE/COMADRE database.</p>
<p>For example, filtering based on part of the metadata, in this case, <code>shapeParam</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">shapeParam</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; A COM(P)ADRE database ('CompadreDB') object with ?? SPECIES and 10 MATRICES.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 10 × 3</span>
<span class="co">#&gt;    mat        idNum shapeParam</span>
<span class="co">#&gt;    &lt;list&gt;     &lt;int&gt;      &lt;int&gt;</span>
<span class="co">#&gt;  1 &lt;CompdrMt&gt;    11          3</span>
<span class="co">#&gt;  2 &lt;CompdrMt&gt;    12          3</span>
<span class="co">#&gt;  3 &lt;CompdrMt&gt;    13          3</span>
<span class="co">#&gt;  4 &lt;CompdrMt&gt;    14          3</span>
<span class="co">#&gt;  5 &lt;CompdrMt&gt;    15          3</span>
<span class="co">#&gt;  6 &lt;CompdrMt&gt;    16          4</span>
<span class="co">#&gt;  7 &lt;CompdrMt&gt;    17          4</span>
<span class="co">#&gt;  8 &lt;CompdrMt&gt;    18          4</span>
<span class="co">#&gt;  9 &lt;CompdrMt&gt;    19          4</span>
<span class="co">#&gt; 10 &lt;CompdrMt&gt;    20          4</span></code></pre></div>
</div>
<div id="including-stage-descriptions-and-version-information" class="section level1">
<h1 class="hasAnchor">
<a href="#including-stage-descriptions-and-version-information" class="anchor"></a>Including stage descriptions and version information</h1>
<p>In the above example, I did not include any information about the stage definitions. Since these information were not provided, <code><a href="../reference/cdb_build_cdb.html">cdb_build_cdb()</a></code> automatically creates some information. You can view that information like this (using square brackets to choose a particular matrix model):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/CompadreMatrixMethods.html">matrixClass</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;   MatrixClassOrganized MatrixClassAuthor MatrixClassNumber</span>
<span class="co">#&gt; 1               active                 1                 1</span>
<span class="co">#&gt; 2               active                 2                 2</span></code></pre></div>
<p>In the following example I illustrate how one can include descriptions of the stages</p>
<p>First I create a data frame describing the matrix stages.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">stageDescriptor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  MatrixClassOrganized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"active"</span>, <span class="fl">2</span><span class="op">)</span>,
  MatrixClassAuthor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"small"</span>, <span class="st">"large"</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   MatrixClassOrganized MatrixClassAuthor</span>
<span class="co">#&gt; 1               active             small</span>
<span class="co">#&gt; 2               active             large</span></code></pre></div>
<p>In this case, all stages are the same and I can simply repeat the <code>stageDescriptor</code> in a list. However, the size of these data frames, and the information within them may vary.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stageDesc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">stageDesc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">stageDescriptor</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdb_build_cdb.html">cdb_build_cdb</a></span><span class="op">(</span>
  mat_a <span class="op">=</span> <span class="va">Alist</span>, metadata <span class="op">=</span> <span class="va">meta</span>, stages <span class="op">=</span> <span class="va">stageDesc</span>,
  version <span class="op">=</span> <span class="st">"Matrices Rock!"</span>
<span class="op">)</span>
<span class="co">#&gt; Warning in cdb_build_cdb(mat_a = Alist, metadata = meta, stages = stageDesc, :</span>
<span class="co">#&gt; Metadata does not include a `SpeciesAccepted` column, so number of species not</span>
<span class="co">#&gt; provided when viewing object.</span></code></pre></div>
<p>Now you can access the stage/class description information like this, using square brackets to find the information for particular matrices.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/CompadreMatrixMethods.html">matrixClass</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;   MatrixClassOrganized MatrixClassAuthor MatrixClassNumber</span>
<span class="co">#&gt; 1               active             small                 1</span>
<span class="co">#&gt; 2               active             large                 2</span>
<span class="fu"><a href="../reference/CompadreMatrixMethods.html">MatrixClassAuthor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] "small" "large"</span></code></pre></div>
<p>You can also obtain the version information.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/CompadreDB.html">Version</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] "Matrices Rock!"</span>
<span class="fu"><a href="../reference/CompadreDB.html">DateCreated</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] "2021-10-14"</span></code></pre></div>
<p>The newly-created database can be saved like this:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">y</span>, <span class="st">"myMatrixDatabase.Rdata"</span><span class="op">)</span></code></pre></div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Caswell, H. (2001). Matrix Population Models: Construction, Analysis, and Interpretation. 2nd edition. Sinauer Associates, Sunderland, MA. ISBN-10: 0878930965</p>
<p>Salguero‐Gómez, R. , Jones, O. R., Archer, C. R., Buckley, Y. M., Che‐Castaldo, J. , Caswell, H. , Hodgson, D. , Scheuerlein, A. , Conde, D. A., Brinks, E. , Buhr, H. , Farack, C. , Gottschalk, F. , Hartmann, A. , Henning, A. , Hoppe, G. , Römer, G. , Runge, J. , Ruoff, T. , Wille, J. , Zeh, S. , Davison, R. , Vieregg, D. , Baudisch, A. , Altwegg, R. , Colchero, F. , Dong, M. , Kroon, H. , Lebreton, J. , Metcalf, C. J., Neel, M. M., Parker, I. M., Takada, T. , Valverde, T. , Vélez‐Espino, L. A., Wardle, G. M., Franco, M. and Vaupel, J. W. (2015), The COMPADRE Plant Matrix Database: an open online repository for plant demography. J Ecol, 103: 202-218. &lt;:10.1111/1365-2745.12334&gt;</p>
<p>Salguero‐Gómez, R. , Jones, O. R., Archer, C. R., Bein, C. , Buhr, H. , Farack, C. , Gottschalk, F. , Hartmann, A. , Henning, A. , Hoppe, G. , Römer, G. , Ruoff, T. , Sommer, V. , Wille, J. , Voigt, J. , Zeh, S. , Vieregg, D. , Buckley, Y. M., Che‐Castaldo, J. , Hodgson, D. , Scheuerlein, A. , Caswell, H. and Vaupel, J. W. (2016), COMADRE: a global data base of animal demography. J Anim Ecol, 85: 371-384. &lt;:10.1111/1365-2656.12482&gt;</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Patrick Barks, Danny Buss, Roberto Salguero-Gomez, Iain Stott, William K. Petry, Tamora James, Owen Jones, Julia Jones, Gesa Römer, Sam Levin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
