<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with Rcompadre • Rcompadre</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with Rcompadre">
<meta property="og:description" content="Rcompadre">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rcompadre</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_GettingStarted.html">Getting started with Rcompadre</a>
    </li>
    <li>
      <a href="../articles/a02_RcompadreTidy.html">Using Rcompadre with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/a03_VectorisingRcompadre.html">Vectorising with Rcompadre</a>
    </li>
    <li>
      <a href="../articles/a04_ObtainingReferences.html">Obtaining references</a>
    </li>
    <li>
      <a href="../articles/a05_UsingYourOwnData.html">Using your own matrix data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jonesor/Rcompadre/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a01_GettingStarted_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with Rcompadre</h1>
                        <h4 class="author">Owen Jones</h4>
            
            <h4 class="date">2021-06-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jonesor/Rcompadre/blob/master/vignettes/a01_GettingStarted.Rmd"><code>vignettes/a01_GettingStarted.Rmd</code></a></small>
      <div class="hidden name"><code>a01_GettingStarted.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The COMPADRE and COMADRE Plant and Animal Matrix Databases contain matrix population models (MPMs) and associated metadata obtained from the published literature (Salguero-Gomez et al. 2015, 2016).</p>
<p>Wherever possible the full MPM (the <strong>A</strong> matrix) has been split into three additional constituent matrices based on the nature of the demographic processes involved. These are the <strong>U</strong> matrix, which summarises growth and survival; the <strong>F</strong> matrix, which summarises sexual reproduction; and the <strong>C</strong> matrix, which summarises asexual (clonal) reproduction. These additional matrices sum to equal the <strong>A</strong> matrix (<strong>A</strong> = <strong>U</strong> + <strong>F</strong> + <strong>C</strong>). Thus, each MPM is presented as a list of these 4 matrices in the databases together with information about the MPM stages defined by the author.</p>
<p>In addition, each set of MPMs is associated with metadata including taxonomy of the species studied, the geographic location, the published source information and so on. For further details please see the two papers on COMPADRE and COMADRE (Salguero-Gomez et al. 2015, 2016), and the User Guide which is available via the website (<a href="https://compadre-db.org/">compadre-db.org/</a>).</p>
<p>The databases are distributed as <code>Rdata</code> files containing a <code>list</code> class object which provides the data in a structured format. Although it is possible to use the database without using the <em>Rcompadre</em> package this is not recommended. <em>Rcompadre</em> provides users with a range of useful tools for working with the database that will greatly improve user experience.</p>
<p>Importantly, <em>Rcompadre</em> coerces the data as a so-called <code>CompadreDB</code> S4 class object. The details of what this means is beyond the scope of this vignette, apart from that the object has two <em>slots</em> called <code>CompadreData</code> and <code>VersionData</code>.</p>
<p><code>CompadreData</code> contains a tibble-style data frame that includes a list column of matrix population models (MPMs) alongside associated metadata columns. Each element of the matrix column of the data frame (<code>mat</code>) contains a list of MPMs, while remaining columns include metadata associated with the matrices, while <code>VersionData</code> is a list of information about the database version. In practice, knowledge of the details of this structure is not necessary thanks to the tools provided by the <code>Rcompadre</code> package.</p>
</div>
<div id="obtaining-and-loading-the-data-" class="section level2">
<h2 class="hasAnchor">
<a href="#obtaining-and-loading-the-data-" class="anchor"></a>Obtaining and loading the data.</h2>
<p>To get started you will first need to download the COMPADRE (or COMADRE) dataset from the website at <a href="https://compadre-db.org/">compadre-db.org/</a>.</p>
<p>When you have done that you can load it into R using <code><a href="https://rdrr.io/r/base/load.html">load()</a></code>. It is usually a good idea to set up your working directory at this point. Assuming you are working in the same directory as your database file we can load the database like this. You should ensure that the database is of the correct class using <code><a href="../reference/as_cdb.html">as_cdb()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"COMPADRE_v.4.0.1.RData"</span><span class="op">)</span>
<span class="va">compadre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_cdb.html">as_cdb</a></span><span class="op">(</span><span class="va">compadre</span><span class="op">)</span></code></pre></div>
<p>Alternatively, <code><a href="../reference/cdb_fetch.html">cdb_fetch()</a></code> will automatically download the latest version of COMPADRE or COMADRE from the website, and ensure it is of the correct class. For example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Compadre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdb_fetch.html">cdb_fetch</a></span><span class="op">(</span><span class="st">'compadre'</span><span class="op">)</span></code></pre></div>
<p>For this vignette we will use the sample of COMPADRE data that is distributed with the package. This dataset is intended for demonstration and learning purposes only and should not be used for real analyses! You can load it like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Compadre</span><span class="op">)</span></code></pre></div>
<p>We can now ask for a summary of this object, which will tell us that it is a <code>CompadreDB</code> class <code>S4</code> object. Simply typing the name of the object (<code>Compadre</code> in this case) will give a brief summary of its contents and display the first few rows of the data (which is a <code>tibble</code>). Please see the <code>tibble</code> vignette<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> for information about this object type, and how it differs from <code>data.table</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Compadre</span><span class="op">)</span>
<span class="co">#&gt;     Length      Class       Mode </span>
<span class="co">#&gt;          1 CompadreDB         S4</span>
<span class="va">Compadre</span>
<span class="co">#&gt; A COM(P)ADRE database ('CompadreDB') object with 110 SPECIES and 150 MATRICES.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 150 x 48</span>
<span class="co">#&gt;    mat    SpeciesAuthor    SpeciesAccepted   CommonName Genus Family Order Class</span>
<span class="co">#&gt;    &lt;list&gt; &lt;chr&gt;            &lt;chr&gt;             &lt;chr&gt;      &lt;chr&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt;</span>
<span class="co">#&gt;  1 &lt;Comp… Setaria_incrass… Setaria incrassa… &lt;NA&gt;       Seta… Poace… Poal… Lili…</span>
<span class="co">#&gt;  2 &lt;Comp… Lechea_cernua    Lechea cernua     &lt;NA&gt;       Lech… Cista… Malv… Magn…</span>
<span class="co">#&gt;  3 &lt;Comp… Actinostemon_co… Actinostemon con… &lt;NA&gt;       Acti… Eupho… Malp… Magn…</span>
<span class="co">#&gt;  4 &lt;Comp… Gaura_neomexica… Gaura neomexican… &lt;NA&gt;       Gaura Onagr… Myrt… Magn…</span>
<span class="co">#&gt;  5 &lt;Comp… Eriogonum_longi… Eriogonum longif… Buckwheat  Erio… Polyg… Cary… Magn…</span>
<span class="co">#&gt;  6 &lt;Comp… Platanthera_hoo… Platanthera hook… &lt;NA&gt;       Plat… Orchi… Aspa… Lili…</span>
<span class="co">#&gt;  7 &lt;Comp… Succisa_pratens… Succisa pratensis &lt;NA&gt;       Succ… Capri… Dips… Magn…</span>
<span class="co">#&gt;  8 &lt;Comp… Haplopappus_rad… Pyrrocoma radiata &lt;NA&gt;       Pyrr… Compo… Aste… Magn…</span>
<span class="co">#&gt;  9 &lt;Comp… Astragalus_trem… Astragalus tremo… &lt;NA&gt;       Astr… Legum… Faba… Magn…</span>
<span class="co">#&gt; 10 &lt;Comp… Plantago_corono… Plantago coronop… &lt;NA&gt;       Plan… Plant… Lami… Magn…</span>
<span class="co">#&gt; # … with 140 more rows, and 40 more variables: Phylum &lt;fct&gt;, Kingdom &lt;fct&gt;,</span>
<span class="co">#&gt; #   OrganismType &lt;fct&gt;, DicotMonoc &lt;fct&gt;, AngioGymno &lt;fct&gt;, Authors &lt;chr&gt;,</span>
<span class="co">#&gt; #   Journal &lt;chr&gt;, YearPublication &lt;chr&gt;, DOI.ISBN &lt;chr&gt;,</span>
<span class="co">#&gt; #   AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;, StudyStart &lt;dbl&gt;,</span>
<span class="co">#&gt; #   StudyEnd &lt;dbl&gt;, AnnualPeriodicity &lt;chr&gt;, NumberPopulations &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MatrixCriteriaSize &lt;fct&gt;, MatrixCriteriaOntogeny &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixCriteriaAge &lt;fct&gt;, MatrixPopulation &lt;chr&gt;, Lat &lt;dbl&gt;, Lon &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Altitude &lt;dbl&gt;, Country &lt;fct&gt;, Continent &lt;fct&gt;, Ecoregion &lt;chr&gt;,</span>
<span class="co">#&gt; #   StudiedSex &lt;fct&gt;, MatrixComposite &lt;fct&gt;, MatrixTreatment &lt;chr&gt;,</span>
<span class="co">#&gt; #   MatrixCaptivity &lt;fct&gt;, MatrixStartYear &lt;dbl&gt;, MatrixStartSeason &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixStartMonth &lt;chr&gt;, MatrixEndYear &lt;dbl&gt;, MatrixEndSeason &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixEndMonth &lt;chr&gt;, MatrixSplit &lt;fct&gt;, MatrixFec &lt;fct&gt;,</span>
<span class="co">#&gt; #   Observation &lt;fct&gt;, MatrixDimension &lt;dbl&gt;, SurvivalIssue &lt;dbl&gt;</span></code></pre></div>
<p>This summary tells us that we have successfully loaded the data, and that there are 150 matrices. The database also contains some Version information which can be accessed using the command <code><a href="../reference/CompadreDB.html">VersionData(Compadre)</a></code>. This includes information including the version number, date created, and link to the database user agreement.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/CompadreDB.html">VersionData</a></span><span class="op">(</span><span class="va">Compadre</span><span class="op">)</span>
<span class="co">#&gt; $Version</span>
<span class="co">#&gt; [1] "X.X.X"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DateCreated</span>
<span class="co">#&gt; [1] "Nov_22_2017"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Agreement</span>
<span class="co">#&gt; [1] "http://www.compadre-db.org/Page/UserAgreement"</span></code></pre></div>
</div>
<div id="exploring-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-the-data" class="anchor"></a>Exploring the data</h2>
<p>The database includes a range of metadata associated with the matrices including taxonomic information, geolocation, details of the publication from which matrix was obtained and so on. A full description of these variables can be found in the User Guide via the COMPADRE website. A list of metadata can be obtained simply by using the <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> command, in the same way that you would for a data frame. Each element of the <code>mat</code> column contains a list of the four matrices (<strong>A</strong>, <strong>U</strong>, <strong>F</strong>, <strong>C</strong>) and information on matrix stages while the other columns are ordinary vectors.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Compadre</span><span class="op">)</span>
<span class="co">#&gt;  [1] "mat"                    "SpeciesAuthor"          "SpeciesAccepted"       </span>
<span class="co">#&gt;  [4] "CommonName"             "Genus"                  "Family"                </span>
<span class="co">#&gt;  [7] "Order"                  "Class"                  "Phylum"                </span>
<span class="co">#&gt; [10] "Kingdom"                "OrganismType"           "DicotMonoc"            </span>
<span class="co">#&gt; [13] "AngioGymno"             "Authors"                "Journal"               </span>
<span class="co">#&gt; [16] "YearPublication"        "DOI.ISBN"               "AdditionalSource"      </span>
<span class="co">#&gt; [19] "StudyDuration"          "StudyStart"             "StudyEnd"              </span>
<span class="co">#&gt; [22] "AnnualPeriodicity"      "NumberPopulations"      "MatrixCriteriaSize"    </span>
<span class="co">#&gt; [25] "MatrixCriteriaOntogeny" "MatrixCriteriaAge"      "MatrixPopulation"      </span>
<span class="co">#&gt; [28] "Lat"                    "Lon"                    "Altitude"              </span>
<span class="co">#&gt; [31] "Country"                "Continent"              "Ecoregion"             </span>
<span class="co">#&gt; [34] "StudiedSex"             "MatrixComposite"        "MatrixTreatment"       </span>
<span class="co">#&gt; [37] "MatrixCaptivity"        "MatrixStartYear"        "MatrixStartSeason"     </span>
<span class="co">#&gt; [40] "MatrixStartMonth"       "MatrixEndYear"          "MatrixEndSeason"       </span>
<span class="co">#&gt; [43] "MatrixEndMonth"         "MatrixSplit"            "MatrixFec"             </span>
<span class="co">#&gt; [46] "Observation"            "MatrixDimension"        "SurvivalIssue"</span></code></pre></div>
<p>We can explore this information in various ways, for example, by producing tables, histograms, or other plots of variables of interest.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Compadre</span><span class="op">$</span><span class="va">DicotMonoc</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Eudicot Monocot </span>
<span class="co">#&gt;     108      37</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">Compadre</span><span class="op">$</span><span class="va">StudyDuration</span>,main <span class="op">=</span> <span class="st">"StudyDuration"</span><span class="op">)</span></code></pre></div>
<p><img src="a01_GettingStarted_files/figure-html/Tables%20and%20Histograms-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Compadre</span><span class="op">$</span><span class="va">Lon</span>,<span class="va">Compadre</span><span class="op">$</span><span class="va">Lat</span>,main <span class="op">=</span> <span class="st">"Location"</span><span class="op">)</span></code></pre></div>
<p><img src="a01_GettingStarted_files/figure-html/Tables%20and%20Histograms-2.png" width="700"></p>
</div>
<div id="finding-data-for-for-a-particular-species" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-data-for-for-a-particular-species" class="anchor"></a>Finding data for for a particular species</h2>
<p>If, for example, you want to check if a species is in the database you can use the <code><a href="../reference/cdb_check_species.html">cdb_check_species()</a></code> function. For example, we can ask if the species <em>Succisa pratensis</em> is present.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cdb_check_species.html">cdb_check_species</a></span><span class="op">(</span><span class="va">Compadre</span>, <span class="st">"Succisa pratensis"</span><span class="op">)</span>
<span class="co">#&gt;             species in_db</span>
<span class="co">#&gt; 1 Succisa pratensis  TRUE</span></code></pre></div>
<p>The function works with vectors of species names as follows.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Succisa pratensis"</span>, <span class="st">"Onodrim ent"</span>, <span class="st">"Aster amellus"</span><span class="op">)</span>
<span class="fu"><a href="../reference/cdb_check_species.html">cdb_check_species</a></span><span class="op">(</span><span class="va">Compadre</span>, <span class="va">spList</span><span class="op">)</span>
<span class="co">#&gt;             species in_db</span>
<span class="co">#&gt; 1 Succisa pratensis  TRUE</span>
<span class="co">#&gt; 2       Onodrim ent FALSE</span>
<span class="co">#&gt; 3     Aster amellus  TRUE</span></code></pre></div>
<p>Optionally, the function can return a subset of the database restricted to matched species names.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">compadre_succisa</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdb_check_species.html">cdb_check_species</a></span><span class="op">(</span><span class="va">Compadre</span>, <span class="st">"Succisa pratensis"</span>, return_db <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">compadre_succisa</span>
<span class="co">#&gt; A COM(P)ADRE database ('CompadreDB') object with 1 SPECIES and 2 MATRICES.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 2 x 48</span>
<span class="co">#&gt;   mat   SpeciesAuthor SpeciesAccepted CommonName Genus Family Order Class Phylum</span>
<span class="co">#&gt;   &lt;lis&gt; &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; </span>
<span class="co">#&gt; 1 &lt;Com… Succisa_prat… Succisa praten… &lt;NA&gt;       Succ… Capri… Dips… Magn… Magno…</span>
<span class="co">#&gt; 2 &lt;Com… Succisa_prat… Succisa praten… &lt;NA&gt;       Succ… Capri… Dips… Magn… Magno…</span>
<span class="co">#&gt; # … with 39 more variables: Kingdom &lt;fct&gt;, OrganismType &lt;fct&gt;,</span>
<span class="co">#&gt; #   DicotMonoc &lt;fct&gt;, AngioGymno &lt;fct&gt;, Authors &lt;chr&gt;, Journal &lt;chr&gt;,</span>
<span class="co">#&gt; #   YearPublication &lt;chr&gt;, DOI.ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;,</span>
<span class="co">#&gt; #   StudyDuration &lt;dbl&gt;, StudyStart &lt;dbl&gt;, StudyEnd &lt;dbl&gt;,</span>
<span class="co">#&gt; #   AnnualPeriodicity &lt;chr&gt;, NumberPopulations &lt;dbl&gt;, MatrixCriteriaSize &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixCriteriaOntogeny &lt;fct&gt;, MatrixCriteriaAge &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixPopulation &lt;chr&gt;, Lat &lt;dbl&gt;, Lon &lt;dbl&gt;, Altitude &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Country &lt;fct&gt;, Continent &lt;fct&gt;, Ecoregion &lt;chr&gt;, StudiedSex &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixComposite &lt;fct&gt;, MatrixTreatment &lt;chr&gt;, MatrixCaptivity &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixStartYear &lt;dbl&gt;, MatrixStartSeason &lt;fct&gt;, MatrixStartMonth &lt;chr&gt;,</span>
<span class="co">#&gt; #   MatrixEndYear &lt;dbl&gt;, MatrixEndSeason &lt;fct&gt;, MatrixEndMonth &lt;chr&gt;,</span>
<span class="co">#&gt; #   MatrixSplit &lt;fct&gt;, MatrixFec &lt;fct&gt;, Observation &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixDimension &lt;dbl&gt;, SurvivalIssue &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="accessing-the-matrices" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-the-matrices" class="anchor"></a>Accessing the matrices</h2>
<p>Matrices in <code>CompadreDB</code> objects are stored in a special vector, called <code>mat</code> as part of the data. However, the matrices are stored as special objects within the data frame and should be addressed using Rcompadre accessor functions to obtain the A, U, F and C matrices (see the User Guide), or information about the stage definitions used.</p>
<p>Thus, to obtain the A matrix, which includes all types of transition one would use the <code><a href="../reference/CompadreMatrixMethods.html">matA()</a></code> function, which will return a list of A matrices from the database (there are equivalent functions, <code><a href="../reference/CompadreMatrixMethods.html">matU()</a></code>, <code><a href="../reference/CompadreMatrixMethods.html">matF()</a></code> and <code><a href="../reference/CompadreMatrixMethods.html">matC()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/CompadreMatrixMethods.html">matA</a></span><span class="op">(</span><span class="va">compadre_succisa</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;      A1    A2    A3    A4    A5    A6</span>
<span class="co">#&gt; A1 0.00 0.000 0.000 0.000 1.006 1.851</span>
<span class="co">#&gt; A2 0.55 0.492 0.150 0.000 0.000 0.000</span>
<span class="co">#&gt; A3 0.25 0.356 0.450 0.067 0.000 0.099</span>
<span class="co">#&gt; A4 0.00 0.137 0.321 0.568 0.358 0.197</span>
<span class="co">#&gt; A5 0.00 0.000 0.064 0.167 0.269 0.197</span>
<span class="co">#&gt; A6 0.00 0.000 0.000 0.184 0.358 0.493</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;           A1        A2      A3   A4         A5</span>
<span class="co">#&gt; A1 0.0600000 0.0000000 0.00000 0.00 3.91724308</span>
<span class="co">#&gt; A2 0.0020685 0.0000000 0.00000 0.00 0.13504696</span>
<span class="co">#&gt; A3 0.0000000 0.7333333 0.40625 0.12 0.01923077</span>
<span class="co">#&gt; A4 0.0000000 0.0000000 0.34375 0.70 0.53846154</span>
<span class="co">#&gt; A5 0.0000000 0.0000000 0.00000 0.14 0.36538462</span></code></pre></div>
<p>Thus one could select particular matrices from this list using <code>[[ ]]</code> syntax</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CompadreMatrixMethods.html">matA</a></span><span class="op">(</span><span class="va">compadre_succisa</span><span class="op">)</span>
<span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt;      A1    A2    A3    A4    A5    A6</span>
<span class="co">#&gt; A1 0.00 0.000 0.000 0.000 1.006 1.851</span>
<span class="co">#&gt; A2 0.55 0.492 0.150 0.000 0.000 0.000</span>
<span class="co">#&gt; A3 0.25 0.356 0.450 0.067 0.000 0.099</span>
<span class="co">#&gt; A4 0.00 0.137 0.321 0.568 0.358 0.197</span>
<span class="co">#&gt; A5 0.00 0.000 0.064 0.167 0.269 0.197</span>
<span class="co">#&gt; A6 0.00 0.000 0.000 0.184 0.358 0.493</span></code></pre></div>
<p>It is often desirable to know what the stages are in the matrices. To access this information you can use the <code><a href="../reference/CompadreMatrixMethods.html">matrixClass()</a></code> function. As with the other matrix accessor functions, the function returns a list which can be subsetted using square brackets.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">classInfo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CompadreMatrixMethods.html">matrixClass</a></span><span class="op">(</span><span class="va">compadre_succisa</span><span class="op">)</span>
<span class="va">classInfo</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt;   MatrixClassOrganized</span>
<span class="co">#&gt; 1               active</span>
<span class="co">#&gt; 2               active</span>
<span class="co">#&gt; 3               active</span>
<span class="co">#&gt; 4               active</span>
<span class="co">#&gt; 5               active</span>
<span class="co">#&gt; 6               active</span>
<span class="co">#&gt;                                                    MatrixClassAuthor</span>
<span class="co">#&gt; 1                                                           Seedling</span>
<span class="co">#&gt; 2                                                           Juvenile</span>
<span class="co">#&gt; 3                                                   Small vegetative</span>
<span class="co">#&gt; 4 Large vegetative (not flowering but larger than small vegetatives)</span>
<span class="co">#&gt; 5                                                    Small flowering</span>
<span class="co">#&gt; 6                                                    Large flowering</span>
<span class="co">#&gt;   MatrixClassNumber</span>
<span class="co">#&gt; 1                 1</span>
<span class="co">#&gt; 2                 2</span>
<span class="co">#&gt; 3                 3</span>
<span class="co">#&gt; 4                 4</span>
<span class="co">#&gt; 5                 5</span>
<span class="co">#&gt; 6                 6</span>
<span class="va">classInfo</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">MatrixClassAuthor</span>
<span class="co">#&gt; [1] "Seedling"                                                          </span>
<span class="co">#&gt; [2] "Juvenile"                                                          </span>
<span class="co">#&gt; [3] "Small vegetative"                                                  </span>
<span class="co">#&gt; [4] "Large vegetative (not flowering but larger than small vegetatives)"</span>
<span class="co">#&gt; [5] "Small flowering"                                                   </span>
<span class="co">#&gt; [6] "Large flowering"</span></code></pre></div>
</div>
<div id="filteringsubsetting-the-database-based-on-metadata" class="section level1">
<h1 class="hasAnchor">
<a href="#filteringsubsetting-the-database-based-on-metadata" class="anchor"></a>Filtering/subsetting the database based on metadata</h1>
<p>It is often desirable to subset the data based on sets of criteria. As with a normal data frame these databases can be subset using <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code>. For example, I could subset to only Eudicot species as follows:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Compadre</span>, <span class="va">DicotMonoc</span> <span class="op">==</span> <span class="st">"Eudicot"</span><span class="op">)</span>
<span class="va">x</span>
<span class="co">#&gt; A COM(P)ADRE database ('CompadreDB') object with 80 SPECIES and 108 MATRICES.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 108 x 48</span>
<span class="co">#&gt;    mat    SpeciesAuthor    SpeciesAccepted   CommonName Genus Family Order Class</span>
<span class="co">#&gt;    &lt;list&gt; &lt;chr&gt;            &lt;chr&gt;             &lt;chr&gt;      &lt;chr&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt;</span>
<span class="co">#&gt;  1 &lt;Comp… Lechea_cernua    Lechea cernua     &lt;NA&gt;       Lech… Cista… Malv… Magn…</span>
<span class="co">#&gt;  2 &lt;Comp… Actinostemon_co… Actinostemon con… &lt;NA&gt;       Acti… Eupho… Malp… Magn…</span>
<span class="co">#&gt;  3 &lt;Comp… Gaura_neomexica… Gaura neomexican… &lt;NA&gt;       Gaura Onagr… Myrt… Magn…</span>
<span class="co">#&gt;  4 &lt;Comp… Eriogonum_longi… Eriogonum longif… Buckwheat  Erio… Polyg… Cary… Magn…</span>
<span class="co">#&gt;  5 &lt;Comp… Succisa_pratens… Succisa pratensis &lt;NA&gt;       Succ… Capri… Dips… Magn…</span>
<span class="co">#&gt;  6 &lt;Comp… Haplopappus_rad… Pyrrocoma radiata &lt;NA&gt;       Pyrr… Compo… Aste… Magn…</span>
<span class="co">#&gt;  7 &lt;Comp… Astragalus_trem… Astragalus tremo… &lt;NA&gt;       Astr… Legum… Faba… Magn…</span>
<span class="co">#&gt;  8 &lt;Comp… Plantago_corono… Plantago coronop… &lt;NA&gt;       Plan… Plant… Lami… Magn…</span>
<span class="co">#&gt;  9 &lt;Comp… Petrocoptis_pse… Silene glaucifol… &lt;NA&gt;       Sile… Caryo… Cary… Magn…</span>
<span class="co">#&gt; 10 &lt;Comp… Astragalus_peck… Astragalus peckii &lt;NA&gt;       Astr… Legum… Faba… Magn…</span>
<span class="co">#&gt; # … with 98 more rows, and 40 more variables: Phylum &lt;fct&gt;, Kingdom &lt;fct&gt;,</span>
<span class="co">#&gt; #   OrganismType &lt;fct&gt;, DicotMonoc &lt;fct&gt;, AngioGymno &lt;fct&gt;, Authors &lt;chr&gt;,</span>
<span class="co">#&gt; #   Journal &lt;chr&gt;, YearPublication &lt;chr&gt;, DOI.ISBN &lt;chr&gt;,</span>
<span class="co">#&gt; #   AdditionalSource &lt;chr&gt;, StudyDuration &lt;dbl&gt;, StudyStart &lt;dbl&gt;,</span>
<span class="co">#&gt; #   StudyEnd &lt;dbl&gt;, AnnualPeriodicity &lt;chr&gt;, NumberPopulations &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MatrixCriteriaSize &lt;fct&gt;, MatrixCriteriaOntogeny &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixCriteriaAge &lt;fct&gt;, MatrixPopulation &lt;chr&gt;, Lat &lt;dbl&gt;, Lon &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Altitude &lt;dbl&gt;, Country &lt;fct&gt;, Continent &lt;fct&gt;, Ecoregion &lt;chr&gt;,</span>
<span class="co">#&gt; #   StudiedSex &lt;fct&gt;, MatrixComposite &lt;fct&gt;, MatrixTreatment &lt;chr&gt;,</span>
<span class="co">#&gt; #   MatrixCaptivity &lt;fct&gt;, MatrixStartYear &lt;dbl&gt;, MatrixStartSeason &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixStartMonth &lt;chr&gt;, MatrixEndYear &lt;dbl&gt;, MatrixEndSeason &lt;fct&gt;,</span>
<span class="co">#&gt; #   MatrixEndMonth &lt;chr&gt;, MatrixSplit &lt;fct&gt;, MatrixFec &lt;fct&gt;,</span>
<span class="co">#&gt; #   Observation &lt;fct&gt;, MatrixDimension &lt;dbl&gt;, SurvivalIssue &lt;dbl&gt;</span></code></pre></div>
<p>These subset arguments can be as complex as needed. For example, to subset to only Eudicot species from the United States or Canada and where the matrix dimension is &gt;2 I could use the following command:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Compadre</span>,<span class="va">DicotMonoc</span> <span class="op">==</span> <span class="st">"Eudicot"</span> <span class="op">&amp;</span> 
              <span class="va">Country</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"USA"</span>, <span class="st">"CAN"</span><span class="op">)</span> <span class="op">&amp;</span> 
              <span class="va">MatrixDimension</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>You can compare compadre data sets using the <code><a href="../reference/cdb_compare.html">cdb_compare()</a></code> command:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cdb_compare.html">cdb_compare</a></span><span class="op">(</span><span class="va">Compadre</span>,<span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Quick Summary...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; cdb1 contains data for:</span>
<span class="co">#&gt; 95 source papers</span>
<span class="co">#&gt; 110 accepted species</span>
<span class="co">#&gt; 150 matrices</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; cdb2 contains data for:</span>
<span class="co">#&gt; 28 source papers</span>
<span class="co">#&gt; 29 accepted species</span>
<span class="co">#&gt; 41 matrices</span></code></pre></div>
<div id="potential-issues-with-mpms" class="section level2">
<h2 class="hasAnchor">
<a href="#potential-issues-with-mpms" class="anchor"></a>Potential issues with MPMs</h2>
<p>Numerous matrix calculations (Caswell 2001) have particular requirements for use. The details are beyond the scope of this vignette, but include things like (1) ergodicity, (2) primitivity, (3) singularity and (4) irreducibility. In addition, most matrix calculations will not work if there are missing values (i.e. <code>NA</code>) in the MPM.</p>
<p>We can flag these by adding metadata using the <code><a href="../reference/cdb_flag.html">cdb_flag()</a></code> function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Compadre_flagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cdb_flag.html">cdb_flag</a></span><span class="op">(</span><span class="va">Compadre</span><span class="op">)</span></code></pre></div>
<p>We could then use <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> like this:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Compadre_flagged</span>, <span class="va">check_NA_A</span> <span class="op">==</span> <span class="cn">FALSE</span> <span class="op">&amp;</span> <span class="va">check_ergodic</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="calculations-from-matrices" class="section level2">
<h2 class="hasAnchor">
<a href="#calculations-from-matrices" class="anchor"></a>Calculations from matrices</h2>
<p>When we have a set of matrices that we want to make calculations from, we can use <code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> to apply a function across all the matrices in the list produced by <code><a href="../reference/CompadreMatrixMethods.html">matA()</a></code>. For example, to calculate lambda from all the <strong>A</strong> matrices we can apply the function <code>eigs()</code> from the <code>popdemo</code> package to obtain lambda for the matrices in the <code>x</code> object produced above. Then we can examine a summary, produce a histogram etc.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambdaVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/CompadreMatrixMethods.html">matA</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">popdemo</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/popdemo/man/eigs.html">eigs</a></span>, what<span class="op">=</span><span class="st">"lambda"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lambdaVals</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.2303  0.9331  1.0024  1.2482  1.1355  6.6145</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">lambdaVals</span>, main <span class="op">=</span> <span class="st">"Lambda values"</span><span class="op">)</span></code></pre></div>
<p><img src="a01_GettingStarted_files/figure-html/matrix%20calculations-1.png" width="700"></p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Caswell, H. (2001). Matrix Population Models: Construction, Analysis, and Interpretation. 2nd edition. Sinauer Associates, Sunderland, MA. ISBN-10: 0878930965</p>
<p>Salguero‐Gómez, R. , Jones, O. R., Archer, C. R., Buckley, Y. M., Che‐Castaldo, J. , Caswell, H. , Hodgson, D. , Scheuerlein, A. , Conde, D. A., Brinks, E. , Buhr, H. , Farack, C. , Gottschalk, F. , Hartmann, A. , Henning, A. , Hoppe, G. , Römer, G. , Runge, J. , Ruoff, T. , Wille, J. , Zeh, S. , Davison, R. , Vieregg, D. , Baudisch, A. , Altwegg, R. , Colchero, F. , Dong, M. , Kroon, H. , Lebreton, J. , Metcalf, C. J., Neel, M. M., Parker, I. M., Takada, T. , Valverde, T. , Vélez‐Espino, L. A., Wardle, G. M., Franco, M. and Vaupel, J. W. (2015), The COMPADRE Plant Matrix Database: an open online repository for plant demography. J Ecol, 103: 202-218. &lt;:10.1111/1365-2745.12334&gt;</p>
<p>Salguero‐Gómez, R. , Jones, O. R., Archer, C. R., Bein, C. , Buhr, H. , Farack, C. , Gottschalk, F. , Hartmann, A. , Henning, A. , Hoppe, G. , Römer, G. , Ruoff, T. , Sommer, V. , Wille, J. , Voigt, J. , Zeh, S. , Vieregg, D. , Buckley, Y. M., Che‐Castaldo, J. , Hodgson, D. , Scheuerlein, A. , Caswell, H. and Vaupel, J. W. (2016), COMADRE: a global data base of animal demography. J Anim Ecol, 85: 371-384. &lt;:10.1111/1365-2656.12482&gt;</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Tibbles: <a href="https://CRAN.R-project.org/package=tibble" class="uri">https://CRAN.R-project.org/package=tibble</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Patrick Barks, Danny Buss, Roberto Salguero-Gomez, Iain Stott, William K. Petry, Tamora James, Owen Jones, Julia Jones, Gesa Römer, Sam Levin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
